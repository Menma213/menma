# Network Architecture Guide

This document explains how your **Website**, **Cloudflare**, and **Bot (BotHosting)** communicate.

## The Big Picture
You have two main components running on two different servers:

1.  **Frontend (Website)**: Hosted on Cloudflare Pages (`https://shinobirpg.online`).
    *   This is what users see in their browser.
    *   It is secure (Green Padlock / HTTPS).
2.  **Backend (Bot)**: Hosted on BotHosting.net (`http://us2.bot-hosting.net:21788`).
    *   This is your Node.js bot (`actualbot.js`).
    *   It runs the logic, saves to `.json` files, and talks to Discord.
    *   It is HTTP (Not secure/No SSL).

---

## The Problem: "Mixed Content"
Browsers have a strict security rule: **A secure website (HTTPS) cannot directly talk to an insecure server (HTTP).**
If `script.js` tries to `fetch('http://us2.bot-hosting.net...')`, the browser blocks it immediately.

## The Solution: Cloudflare Proxy
We used a **Cloudflare Function** to act as a middleman.

### How Data Flows (The "Bridge")
1.  **Browser (User)**:
    *   User finishes the intro.
    *   `script.js` sends data to `https://shinobirpg.online/api/track-view`.
    *   Browser is happy because it's talking to a secure HTTPS link (Relative path).

2.  **Cloudflare (The Middleman)**:
    *   Cloudflare receives this request at its "Edge Server".
    *   It looks at your code in `website/functions/api/track-view.js`.
    *   This code says: "Forward this data to `http://us2.bot-hosting.net:21788`".
    *   **Crucial Part:** Cloudflare (a server) *is* allowed to talk to insecure HTTP servers. It doesn't have the same strict rules as a browser.

3.  **BotHosting (The Destination)**:
    *   Your `actualbot.js` receives the request from Cloudflare.
    *   It updates `korilore.json`.
    *   It sends a `200 OK` back to Cloudflare.

4.  **Return Trip**:
    *   Cloudflare sends the `200 OK` back to the User's Browser.
    *   The website logs "Tracking Success".

## Deployment Checklist
*   **Website Folder**: Goes to **Cloudflare**. Creates the UI and the Proxy Function.
*   **Bot Files**: Go to **BotHosting**. Runs the actual logic and stores data.

## Why 502/521 Errors Happened?
*   **521 (Server Down)**: Cloudflare tried to reach your bot, but the address was wrong or the bot was off. (We fixed this by using the direct IP `us2...` instead of the custom domain).
*   **502 (Bad Gateway)**: Cloudflare connected, but the bot sent back garbage or disconnected immediately. (Usually happens if protocols mismatch or bot crashes).

---
*Generated by Antigravity*
